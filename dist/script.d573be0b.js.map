{"version":3,"sources":["js/UINotification.js","js/models/Settings.js","js/Event.js","js/Dom.js","js/debounce.js","js/Database.js","js/Migrations.js","js/models/BaseModel.js","js/models/ChatMessage.js","js/models/Chat.js","js/AppController.js","js/ChatListItem.js","js/DragAndDrop.js","js/ChatList.js","js/models/LocalStorage.js","js/Sidebar.js","js/CopyButton.js","js/OllamaApi.js","js/DownloadButton.js","js/DropDownMenu.js","js/Modal.js","js/List.js","js/models/Models.js","js/ModelsList.js","js/SettingsDialog.js","js/ChatSettingsDialog.js","js/Hoverable.js","js/ChatTitle.js","js/ChatForm.js","js/ChatArea.js","js/App.js","js/script.js","../../../../../usr/local/lib/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["simpleHash","str","hash","i","length","char","charCodeAt","UINotification","constructor","message","type","id","JSON","stringify","domId","container","document","body","template","getElementById","content","_bindEventListeners","window","addEventListener","event","key","hide","show","notification","initialize","originalConsoleError","console","error","_len","arguments","args","Array","_key","apply","handleApplicationError","debug","clone","cloneNode","notificationElement","querySelector","textContent","classList","add","closeButton","onclick","appendChild","remove","exports","Settings","set","value","stringValue","localStorage","setItem","e","get","defaultValue","undefined","getItem","parse","removeItem","getUrl","uri","baseUrl","URL","href","setUrl","url","getModel","setModel","model","getSystemPrompt","setSystemPrompt","systemPrompt","getModelParameters","setModelParameters","modelParameters","getCurrentChatId","setCurrentChatId","chatId","Event","listen","eventName","handler","detail","emit","data","log","CustomEvent","bubbles","dispatchEvent","DOM","showElement","element","hideElement","enableInput","removeAttribute","disableInput","setAttribute","debounce","func","wait","timeout","funcWrapper","later","clearTimeout","setTimeout","Database","dbName","objectStores","migrations","dbConnection","open","Error","Promise","resolve","reject","request","indexedDB","version","onerror","target","onupgradeneeded","db","result","transaction","currentTarget","upgrade","oldVersion","onsuccess","storeName","mode","objectStore","store","handleRequest","put","delete","getAll","clear","Migrations","database","funcName","upgradeFunc","upgradeToVersion2","context","createObjectStore","keyPath","autoIncrement","chatMessages","createIndex","unique","_Database","require","_Migrations","BaseModel","Object","assign","name","create","save","records","map","getAllByIndexAndId","indexName","index","messages","_BaseModel","ChatMessage","getAllByChatId","_ChatMessage","Chat","addMessage","getMessages","chat","_Event","_Chat","_Settings","AppController","updateChat","createChat","title","deleteChatMessage","messageId","deleteChat","getCurrentChat","setCurrentChat","clearChats","_AppController","ChatListItem","chatList","selected","setTitle","bindEventListeners","render","onMouseover","bind","onMouseout","onClick","selectChat","chatTitle","DragAndDrop","selector","listItems","querySelectorAll","draggedItem","initializeDragAndDrop","forEach","item","handleDragStart","handleDragOver","handleDrop","handleDragEnd","preventDefault","currentHTML","innerHTML","_ChatListItem","_DragAndDrop","ChatList","then","handleChatCreated","handleChatDeleted","handleChatsCleared","handleChatUpdated","handleChatSelected","appendChat","elements","listElement","previousListElement","newListElement","currentChatId","chats","chatListItem","LocalStorage","_debounce","_ChatList","_LocalStorage","Sidebar","settings","newChatButton","clearButton","hamburgerButton","searchButton","searchRow","searchInput","toggleSearch","performSearch","handleNewChat","handleClear","toggle","listItem","scrollIntoView","behavior","block","inline","focus","escapeRegExp","string","replace","query","trim","queryContent","regex","RegExp","matches","filter","match","test","includes","contains","CopyButton","targetSelector","getAttribute","textToCopy","innerText","textarea","createElement","select","execCommand","removeChild","alert","OllamaApi","abortController","send","onResponse","onError","onDone","response","postChatMessage","handleResponse","AbortController","signal","fetch","method","headers","ok","status","reader","getReader","partialLine","isRequestDone","done","read","textChunk","TextDecoder","decode","lines","split","pop","line","responseData","printResponseStats","abort","total_duration","totalDurationInSeconds","loadDurationInSeconds","load_duration","promptEvalDurationInSeconds","prompt_eval_duration","responseEvalDurationInSeconds","eval_duration","tokensPerSecond","eval_count","output","created_at","toFixed","prompt_eval_count","getModels","json","models","catch","DownloadButton","targetId","downloadElementContent","elementId","filename","blob","Blob","a","createObjectURL","download","click","revokeObjectURL","DropDownMenu","buttonSelector","dropDownMenus","init","menuElement","closest","dropDownMenu","toggleMenu","menu","Modal","modal","handleShow","handleHide","List","containerId","items","clickHandler","setItems","setSelected","getSelected","ul","li","_OllamaApi","Models","load","getNames","findModelByName","find","_List","_Models","ModelsList","selectedModel","modelList","handleModelsLoaded","_Modal","_UINotification","_ModelsList","SettingsDialog","showButton","urlInput","modelInput","systemPromptInput","modelParametersInput","refreshModelsButton","loadSettings","parsedValue","prettyJSON","refreshModels","ChatSettingsDialog","Hoverable","hoverable","ChatTitle","defaultTitle","hasFocus","activeElement","handleSave","blur","ChatForm","chatHistory","messageInput","sendButton","abortButton","_Hoverable","_ChatTitle","_ChatForm","ChatArea","chatForm","editChatButton","scrollToTopButton","scrollToEndButton","deleteChatButton","createMessageDiv","scrollToEnd","scrollToTop","handleEditChat","handleDeleteChat","currentMessage","next","previous","nextElementSibling","firstElementChild","previousElementSibling","lastElementChild","role","messageClone","messageDiv","textSpan","deleteButton","spellcheck","dataset","stopPropagation","scrollTop","scrollHeight","_Dom","_Sidebar","_CopyButton","_DownloadButton","_DropDownMenu","_SettingsDialog","_ChatSettingsDialog","_ChatArea","App","run","app","sidebar","chatArea","ollamaApi","settingsDialog","chatSettingsDialog","downloadButton","copyButton","initializeElements","logInitialization","msg","handleAbort","handleKeyPress","history","pushState","enableForm","shiftKey","sendMessage","disableForm","userMessage","createChatMessage","responseElement","requestContext","requestData","prompt","system","options","handleResponseError","handleDone","sanitizedContent","sanitizeContent","getIdParam","location","pathname","_App","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","stack","overlay","createErrorOverlay","stackTrace","getParents","modules","parents","k","d","dep","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"script.d573be0b.js","sourceRoot":"..","sourcesContent":["function simpleHash(str) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = (hash << 5) - hash + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  return hash;\n}\n\n// Show all uncaught errors as UI notifications\n/*\nwindow.onerror = function (message, source, lineno, colno, error) {\n  const errorDetails = `${message} at ${source}:${lineno}:${colno}`;\n  UINotification.show(errorDetails, 'error');\n  return true;\n};\n*/\n\nexport class UINotification {\n  constructor(message, type) {\n    const id = simpleHash(JSON.stringify(message));\n    this.type = type;\n    this.domId = `notification-${id}`;\n    this.container = document.body;\n    this.template = document.getElementById('notification-template').content;\n    this._bindEventListeners();\n  }\n\n  _bindEventListeners() {\n    window.addEventListener('keydown', (event) => {\n      if (event.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  static show(message, type) {\n    const notification = new UINotification(message, type);\n    notification.show(message);\n  }\n\n  static initialize() {\n    // Store the original console.error function\n    const originalConsoleError = console.error;\n\n    // Override console.error\n    console.error = function (...args) {\n      UINotification.show(args);\n      // Call the original console.error with all arguments\n      originalConsoleError.apply(console, args);\n    };\n  }\n\n  static handleApplicationError(error) {\n    console.debug('caught error');\n    console.error(error);\n    UINotification.show(error);\n  }\n\n  show(message) {\n    // Clone the template\n    const clone = this.template.cloneNode(true);\n\n    // Find the root element of the notification in the clone\n    const notificationElement = clone.querySelector('.notification');\n    if (!notificationElement) {\n      console.error('Notification root element not found in template');\n      return;\n    }\n\n    // Set the message\n    clone.querySelector('.notification-message').textContent = message;\n\n    notificationElement.id = this.domId; // Set ID on the actual element, not the fragment\n    // Add type, for example, error\n    if (this.type) {\n      notificationElement.classList.add(`notification-${this.type}`);\n    }\n\n    // Add close functionality\n    const closeButton = clone.querySelector('.close-notification-button');\n    closeButton.onclick = () => this.hide();\n\n    // Don't show the same notification twice\n    if (!document.getElementById(this.domId)) {\n      // Append to the container and display\n      this.container.appendChild(clone);\n    }\n  }\n\n  hide() {\n    document.getElementById(this.domId)?.remove();\n  }\n}\n","export class Settings {\n  // Static method to set a value in localStorage\n  static set(key, value) {\n    try {\n      const stringValue = JSON.stringify(value);\n      localStorage.setItem(key, stringValue);\n    } catch (e) {\n      console.error('Error saving to localStorage', e);\n    }\n  }\n\n  // Static method to get a value from localStorage\n  static get(key, defaultValue = null) {\n    try {\n      const value = localStorage.getItem(key);\n      return value !== null ? JSON.parse(value) : defaultValue;\n    } catch (e) {\n      console.error('Error reading from localStorage', e);\n      return defaultValue;\n    }\n  }\n\n  // Static method to remove a value from localStorage\n  static remove(key) {\n    try {\n      localStorage.removeItem(key);\n    } catch (e) {\n      console.error('Error removing from localStorage', e);\n    }\n  }\n\n  static getUrl(uri) {\n    try {\n      const baseUrl = Settings.get('url');\n      if (uri) {\n        return new URL(uri, baseUrl).href;\n      } else {\n        return baseUrl;\n      }\n    } catch (error) {\n      return null;\n    }\n  }\n\n  static setUrl(url) {\n    Settings.set('url', url);\n  }\n\n  static getModel() {\n    return Settings.get('model');\n  }\n\n  static setModel(model) {\n    Settings.set('model', model);\n  }\n\n  static getSystemPrompt() {\n    return Settings.get('system-prompt');\n  }\n\n  static setSystemPrompt(systemPrompt) {\n    if (systemPrompt === '') {\n      systemPrompt = null;\n    }\n    Settings.set('system-prompt', systemPrompt);\n  }\n\n  static getModelParameters() {\n    return Settings.get('model-parameters');\n  }\n\n  static setModelParameters(modelParameters) {\n    if (modelParameters === '') {\n      modelParameters = null;\n    }\n    Settings.set('model-parameters', modelParameters);\n  }\n\n  static getCurrentChatId() {\n    return Settings.get('currentChatId');\n  }\n\n  static setCurrentChatId(chatId) {\n    if (chatId === undefined) {\n      chatId = null;\n    }\n    Settings.set('currentChatId', chatId);\n  }\n}\n","export class Event {\n  static listen(eventName, handler) {\n    window.addEventListener(eventName, (event) => {\n      handler(event.detail);\n    });\n  }\n\n  static emit(eventName, data) {\n    let log = `${eventName}`;\n    if (data?.id) {\n      log += ` id: ${data.id}`;\n    }\n    console.log(log);\n    const event = new CustomEvent(eventName, {\n      detail: data || {},\n      bubbles: true, // This makes the event bubble up through the DOM\n    });\n    window.dispatchEvent(event);\n  }\n}\n","export class DOM {\n  static showElement(element) {\n    element.classList.remove('hidden');\n    return this;\n  }\n\n  static hideElement(element) {\n    element.classList.add('hidden');\n    return this;\n  }\n\n  static enableInput(element) {\n    element.removeAttribute('disabled');\n    return this;\n  }\n\n  static disableInput(element) {\n    element.setAttribute('disabled', 'disabled');\n    return this;\n  }\n}\n","export function debounce(func, wait) {\n  let timeout;\n\n  return function funcWrapper(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n","export class Database {\n  constructor(dbName, objectStores, migrations) {\n    this.dbName = dbName;\n    this.objectStores = objectStores;\n    this.dbConnection = null; // Initialized in open\n    this.migrations = migrations;\n  }\n\n  async open() {\n    if (this.dbConnection) {\n      throw new Error('Connection already open');\n    }\n\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.migrations.version);\n\n      request.onerror = (event) => reject(event.target.error);\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        const transaction = event.currentTarget.transaction;\n        this.migrations.upgrade(db, transaction, event.oldVersion);\n      };\n      request.onsuccess = (event) => {\n        this.dbConnection = event.target.result;\n        resolve(this.dbConnection);\n      };\n    });\n  }\n\n  async transaction(storeName, mode) {\n    return this.dbConnection\n      .transaction([storeName], mode)\n      .objectStore(storeName);\n  }\n\n  async add(storeName, data) {\n    const store = await this.transaction(storeName, 'readwrite');\n    return this.handleRequest('add', store.add(data));\n  }\n\n  async get(storeName, id) {\n    const store = await this.transaction(storeName, 'readonly');\n    return this.handleRequest('get', store.get(id));\n  }\n\n  async put(storeName, data) {\n    const store = await this.transaction(storeName, 'readwrite');\n    return this.handleRequest('put', store.put(data));\n  }\n\n  async delete(storeName, id) {\n    const store = await this.transaction(storeName, 'readwrite');\n    return this.handleRequest('delete', store.delete(id));\n  }\n\n  async getAll(storeName) {\n    const store = await this.transaction(storeName, 'readwrite');\n    return this.handleRequest('getAll', store.getAll());\n  }\n\n  async clear(storeName) {\n    const store = await this.transaction(storeName, 'readwrite');\n    return this.handleRequest('deleteAll', store.clear());\n  }\n\n  handleRequest(type, request) {\n    return new Promise((resolve, reject) => {\n      request.onsuccess = () => resolve(request.result);\n\n      request.onerror = (event) => {\n        const error = `Database ${type} operation failed: ${event.target.error.message}`;\n        reject(new Error(JSON.stringify(error)));\n      };\n    });\n  }\n}\n","export class Migrations {\n  static version = 2;\n  static upgrade(database, transaction, oldVersion) {\n    console.debug(\n      `Migration needed. Old version ${oldVersion}. New version ${this.version}.`,\n    );\n    const funcName = `upgradeToVersion${this.version}`;\n    const upgradeFunc = this[funcName];\n    if (!upgradeFunc) {\n      throw new Error(`Upgrade function missing for ${funcName}`);\n    }\n    if (this.version >= oldVersion) {\n      upgradeFunc({ database, transaction });\n    }\n  }\n\n  static upgradeToVersion2(context) {\n    // Create chats\n    context.database.createObjectStore('chats', {\n      keyPath: 'id',\n      autoIncrement: true,\n    });\n    // Create chat_messages\n    const chatMessages = context.database.createObjectStore('chat_messages', {\n      keyPath: 'id',\n      autoIncrement: true,\n    });\n    chatMessages.createIndex('by_chat', 'chatId', { unique: false });\n  }\n}\n","import { Database } from '../Database.js';\nimport { Migrations } from '../Migrations.js';\n\nexport class BaseModel {\n  constructor(data) {\n    Object.assign(this, data);\n  }\n\n  static async database(name, store) {\n    this.dbName = name;\n    this.storeName = store;\n    this.db = new Database(name, [store], Migrations);\n    await this.db.open();\n  }\n\n  static async transaction(mode) {\n    return await this.db.transaction(this.storeName, mode);\n  }\n\n  async transaction(mode) {\n    return await this.constructor.transaction(mode);\n  }\n\n  async create() {\n    const key = await this.constructor.db.add(this.constructor.storeName, this);\n    if (!this.id) {\n      this.id = key;\n    }\n    return this;\n  }\n\n  async save() {\n    return await this.constructor.db.put(this.constructor.storeName, this);\n  }\n\n  async delete() {\n    return await this.constructor.db.delete(\n      this.constructor.storeName,\n      this.id,\n    );\n  }\n\n  static async get(id) {\n    const data = await this.db.get(this.storeName, id);\n    return new this(data);\n  }\n\n  static async clear() {\n    return await this.db.clear(this.storeName);\n  }\n\n  // TODO: sorting and selecting only certain attributes\n  static async getAll() {\n    const records = await this.db.getAll(this.storeName);\n    return records.map((data) => new this(data));\n  }\n\n  /**\n   * Retrieves all objects associated with a given ID and index.\n   *\n   * @param {number|string} chatId - The ID of the chat.\n   * @returns {Promise<Array>} A promise that resolves to an array.\n   */\n  static async getAllByIndexAndId(indexName, id) {\n    // Open a transaction and access the messages store\n    const transaction = await this.transaction('readonly');\n\n    // Use an index to find objects with the specified id\n    const index = transaction.index(indexName);\n    const request = index.getAll(id);\n\n    return new Promise((resolve, reject) => {\n      request.onsuccess = () => {\n        // Convert the result into instances\n        const messages = request.result.map((data) => new this(data));\n        resolve(messages);\n      };\n      request.onerror = () => {\n        reject(request.error);\n      };\n    });\n  }\n}\n","import { BaseModel } from './BaseModel.js';\n\nexport class ChatMessage extends BaseModel {\n  static async initialize() {\n    await this.database('ChatApp', 'chat_messages');\n  }\n\n  static async getAllByChatId(chatId) {\n    return this.getAllByIndexAndId('by_chat', chatId);\n  }\n}\n","import { BaseModel } from './BaseModel.js';\nimport { ChatMessage } from './ChatMessage.js';\n\nexport class Chat extends BaseModel {\n  async addMessage(data) {\n    data.chatId = this.id;\n    await new ChatMessage(data).create();\n  }\n\n  async getMessages() {\n    const messages = await ChatMessage.getAllByChatId(this.id);\n    this.messages = messages;\n    return this.messages;\n  }\n\n  static async initialize() {\n    await this.database('ChatApp', ['chats']);\n  }\n\n  static async clear() {\n    await ChatMessage.clear();\n    await super.clear();\n  }\n\n  static async get(id) {\n    const chat = await super.get(id);\n\n    if (chat) {\n      // Fetch all messages for this chat\n      const messages = await ChatMessage.getAllByChatId(id);\n      chat.messages = messages;\n    }\n\n    return chat;\n  }\n\n  static async delete(id) {\n    // Delete the chat instance\n    await super.delete(id);\n\n    // Delete all associated messages\n    const messages = await ChatMessage.getAllByChatId(id);\n    for (const message of messages) {\n      await message.delete();\n    }\n  }\n}\n","import { Event } from './Event.js';\nimport { Chat } from './models/Chat.js';\nimport { ChatMessage } from './models/ChatMessage.js';\nimport { Settings } from './models/Settings.js';\n\nexport class AppController {\n  static async updateChat(chat, data) {\n    Object.assign(chat, data);\n    await chat.save();\n    // TODO: Move to BaseModel\n    Event.emit('chatUpdated', chat);\n  }\n\n  static async createChat(data) {\n    if (!data) {\n      data = {};\n    }\n    if (!data.title) {\n      data.title = 'Untitled';\n    }\n    if (!data.model) {\n      data.model = Settings.getModel();\n    }\n    const chat = await new Chat(data).create();\n    Settings.setCurrentChatId(chat.id);\n    Event.emit('chatCreated', chat);\n    Event.emit('chatSelected', chat);\n    return chat;\n  }\n\n  static async deleteChatMessage(messageId) {\n    const message = await ChatMessage.get(messageId);\n    message.delete();\n  }\n\n  static async deleteChat(chat) {\n    await chat.delete();\n    if (Settings.getCurrentChatId() === chat.id) {\n      Settings.setCurrentChatId(null);\n    }\n    Event.emit('chatDeleted', chat);\n  }\n\n  static async getCurrentChat() {\n    const chatId = this.getCurrentChatId();\n    if (chatId) {\n      return await Chat.get(chatId);\n    }\n    return null;\n  }\n\n  static getCurrentChatId() {\n    return Settings.get('currentChatId');\n  }\n\n  static async setCurrentChat(chat) {\n    Settings.setCurrentChatId(chat.id);\n    Event.emit('chatSelected', chat);\n  }\n\n  static async setCurrentChatId(chatId) {\n    const chat = await Chat.get(chatId);\n    if (chat) {\n      await this.setCurrentChat(chat);\n    }\n  }\n\n  static async clearChats() {\n    Settings.setCurrentChatId(null);\n    await Chat.clear();\n    Event.emit('chatsCleared');\n  }\n}\n","import { AppController } from './AppController.js';\n\nexport class ChatListItem {\n  constructor(chat, chatList, selected) {\n    this.chat = chat;\n    this.chatList = chatList;\n    this.content = document\n      .getElementById('chat-list-item-template')\n      .content.cloneNode(true);\n    this.element = this.content.querySelector('.chat-list-item');\n    this.element.title = this.chat.title;\n    this.element.data = { id: this.chat.id };\n    this.element.classList.add(`chat${this.chat.id}`);\n    if (selected === true) {\n      this.element.classList.add('selected');\n      // this.content.querySelector('.icon-selected').classList.remove('hidden')\n    }\n    this.setTitle();\n    this.bindEventListeners();\n  }\n\n  render() {}\n\n  bindEventListeners() {\n    this.element.addEventListener('mouseover', this.onMouseover.bind(this));\n    this.element.addEventListener('mouseout', this.onMouseout.bind(this));\n    this.element.addEventListener('click', this.onClick.bind(this));\n    this.element\n      .querySelector('.list-item-delete')\n      .addEventListener('click', this.deleteChat.bind(this));\n  }\n\n  onMouseover() {\n    this.element.classList.add('hover');\n  }\n\n  onMouseout() {\n    this.element.classList.remove('hover');\n  }\n\n  onClick() {\n    this.chatList.selectChat(this.chat.id);\n  }\n\n  setTitle() {\n    const chatTitle = this.content.querySelector('.chat-title');\n    chatTitle.textContent = this.chat.title;\n  }\n\n  deleteChat() {\n    AppController.deleteChat(this.chat);\n    this.element.remove();\n  }\n}\n","export class DragAndDrop {\n  constructor(selector) {\n    this.listItems = document.querySelectorAll(selector);\n    this.draggedItem = null;\n    this.initializeDragAndDrop();\n  }\n\n  initializeDragAndDrop() {\n    this.listItems.forEach((item) => {\n      item.addEventListener('dragstart', this.handleDragStart.bind(this, item));\n      item.addEventListener('dragover', this.handleDragOver.bind(this));\n      item.addEventListener('drop', this.handleDrop.bind(this, item));\n      item.addEventListener('dragend', this.handleDragEnd.bind(this));\n    });\n  }\n\n  handleDragStart(item) {\n    this.draggedItem = item;\n  }\n\n  handleDragOver(e) {\n    e.preventDefault();\n  }\n\n  handleDrop(item) {\n    if (item !== this.draggedItem) {\n      let currentHTML = item.innerHTML;\n      item.innerHTML = this.draggedItem.innerHTML;\n      this.draggedItem.innerHTML = currentHTML;\n      console.debug('dnd drop');\n    }\n  }\n\n  handleDragEnd() {\n    this.draggedItem = null;\n  }\n}\n","import { Event } from './Event.js';\nimport { ChatListItem } from './ChatListItem.js';\nimport { DragAndDrop } from './DragAndDrop.js';\nimport { Chat } from './models/Chat.js';\nimport { AppController } from './AppController.js';\n\nexport class ChatList {\n  constructor() {\n    this.element = document.getElementById('chat-list');\n    this.template = document.getElementById('chat-list-item-template').content;\n    this.bindEventListeners();\n    AppController.getCurrentChat().then((chat) => {\n      this.chat = chat;\n    });\n  }\n\n  bindEventListeners() {\n    Event.listen('chatCreated', this.handleChatCreated.bind(this));\n    Event.listen('chatDeleted', this.handleChatDeleted.bind(this));\n    Event.listen('chatsCleared', this.handleChatsCleared.bind(this));\n    Event.listen('chatUpdated', this.handleChatUpdated.bind(this));\n    Event.listen('chatSelected', this.handleChatSelected.bind(this));\n  }\n\n  async selectChat(chatId) {\n    await AppController.setCurrentChatId(chatId);\n  }\n\n  handleChatCreated(chat) {\n    this.appendChat(chat, true);\n  }\n\n  handleChatDeleted(chat) {\n    if (this.chat?.id === chat.id) {\n      this.chat = null;\n    }\n    this.element.querySelector(`.chat${chat.id}`)?.remove();\n  }\n\n  handleChatsCleared() {\n    const elements = this.element.querySelectorAll('.chat-list-item');\n    elements.forEach((element) => element.remove());\n  }\n\n  handleChatUpdated(chat) {\n    const listElement = this.element.querySelector(\n      `.chat${chat.id} .chat-title`,\n    );\n    if (listElement) {\n      listElement.textContent = chat.title;\n    }\n  }\n\n  handleChatSelected(chat) {\n    if (this.chat) {\n      const previousListElement = this.element.querySelector(\n        `.chat${this.chat.id}`,\n      );\n      if (previousListElement) {\n        previousListElement.classList.remove('selected');\n      }\n    }\n    const newListElement = this.element.querySelector(`.chat${chat.id}`);\n    if (newListElement) {\n      newListElement.classList.add('selected');\n    }\n    // Remember selected chat\n    this.chat = chat;\n  }\n\n  render() {\n    const currentChatId = AppController.getCurrentChatId();\n    this.element.innerHTML = '';\n    Chat.getAll().then((chats) => {\n      chats.forEach((chat) => {\n        const selected = chat.id === currentChatId;\n        this.appendChat(chat, selected);\n      });\n      new DragAndDrop('.chat-list-item');\n    });\n  }\n\n  appendChat(chat, selected) {\n    const chatListItem = new ChatListItem(chat, this, selected);\n    this.element.appendChild(chatListItem.element);\n    return chatListItem;\n  }\n}\n","export class LocalStorage {\n  // Set a value in localStorage\n  set(key, value) {\n    try {\n      const stringValue = JSON.stringify(value);\n      localStorage.setItem(key, stringValue);\n    } catch (e) {\n      console.error('Error saving to localStorage', e);\n    }\n  }\n\n  // Get a value from localStorage, return defaultValue if key doesn't exist\n  get(key, defaultValue = null) {\n    try {\n      const value = localStorage.getItem(key);\n      return value !== null ? JSON.parse(value) : defaultValue;\n    } catch (e) {\n      console.error('Error reading from localStorage', e);\n      return defaultValue;\n    }\n  }\n\n  // Remove a value from localStorage\n  remove(key) {\n    try {\n      localStorage.removeItem(key);\n    } catch (e) {\n      console.error('Error removing from localStorage', e);\n    }\n  }\n}\n","import { debounce } from './debounce.js';\nimport { Event } from './Event.js';\nimport { Chat } from './models/Chat.js';\nimport { AppController } from './AppController.js';\nimport { ChatList } from './ChatList.js';\nimport { LocalStorage } from './models/LocalStorage.js';\n\nexport class Sidebar {\n  constructor() {\n    this.settings = new LocalStorage();\n    this.chatList = new ChatList();\n    this.element = document.getElementById('sidebar');\n    this.newChatButton = this.element.querySelector('#new-chat-button');\n    this.clearButton = this.element.querySelector('#clear-button');\n    this.hamburgerButton = document.getElementById('hamburger-menu');\n    this.searchButton = document.getElementById('search-button');\n    this.searchRow = document.getElementById('search-row');\n    this.searchInput = document.getElementById('search-input');\n    if (this.settings.get('sidebar-collapsed') === true) {\n      this.element.classList.add('collapsed');\n    }\n    this.bindEventListeners();\n  }\n\n  render() {\n    this.chatList.render();\n  }\n\n  bindEventListeners() {\n    Event.listen('chatSelected', this.handleChatSelected);\n    this.searchButton.addEventListener('click', this.toggleSearch.bind(this));\n    this.searchInput.addEventListener(\n      'keypress',\n      debounce(this.performSearch.bind(this), 50),\n    );\n    this.searchInput.addEventListener(\n      'keyup',\n      debounce(this.performSearch.bind(this), 50),\n    );\n    this.newChatButton.addEventListener('click', this.handleNewChat.bind(this));\n    this.clearButton.addEventListener('click', this.handleClear.bind(this));\n    this.hamburgerButton.addEventListener('click', this.toggle.bind(this));\n  }\n\n  // TODO: Fix\n  handleChatSelected = (chat) => {\n    const listItem = this.element.querySelector(`chat${chat.id}`);\n    if (listItem) {\n      listItem.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start', // \"start\" will bring the top of the element into view\n        inline: 'nearest', // \"nearest\" will scroll to the nearest edge if partially visible\n      });\n    }\n  };\n\n  toggleSearch() {\n    const searchRow = document.getElementById('search-row');\n    searchRow.classList.toggle('hidden');\n    this.searchInput.focus();\n  }\n\n  performSearch() {\n    function escapeRegExp(string) {\n      return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // Escapes special characters\n    }\n    const query = escapeRegExp(this.searchInput.value.trim()).replace(\n      /\\s+/g,\n      '.*',\n    );\n    const queryContent = query.length > 2; // Nobody wants to query content based on one character?\n    const regex = new RegExp(query, 'i'); // 'i' for case-insensitive matching\n    console.log(`Search ${query}`);\n    Chat.getAll().then((chats) => {\n      const matches = chats\n        .filter((chat) => {\n          let match = regex.test(chat.title);\n          if (queryContent) {\n            match ||= regex.test(chat.content);\n          }\n          return match;\n        })\n        .map((chat) => chat.id);\n      this.element.querySelectorAll('.chat-list-item').forEach((item) => {\n        if (matches.includes(item.data.id)) {\n          // Now matches the type\n          item.classList.remove('hidden');\n        } else {\n          item.classList.add('hidden');\n        }\n      });\n    });\n  }\n\n  toggle() {\n    this.element.classList.toggle('collapsed');\n    this.hamburgerButton.classList.toggle('collapsed');\n    if (this.element.classList.contains('collapsed')) {\n      this.settings.set('sidebar-collapsed', true);\n    } else {\n      this.settings.set('sidebar-collapsed', false);\n    }\n  }\n\n  async handleNewChat() {\n    await AppController.createChat();\n  }\n\n  async handleClear() {\n    await AppController.clearChats();\n  }\n}\n","export class CopyButton {\n  constructor() {\n    document.addEventListener('click', function (event) {\n      // Check if the clicked element has the class 'copy-button'\n      if (event.target.classList.contains('copy-button')) {\n        const targetSelector = event.target.getAttribute('data-target');\n        const textToCopy = document.getElementById(targetSelector).innerText;\n        // Create a temporary textarea element\n        const textarea = document.createElement('textarea');\n        textarea.value = textToCopy;\n        document.body.appendChild(textarea);\n\n        // Select the text and copy it\n        textarea.select();\n        document.execCommand('copy');\n\n        // Remove the temporary textarea\n        document.body.removeChild(textarea);\n\n        // Optional: Display a message or change the button text/content\n        alert('Text copied to clipboard');\n      }\n    });\n  }\n}\n","export class OllamaApi {\n  constructor() {\n    this.abortController = null;\n  }\n\n  async send(url, data, onResponse, onError, onDone) {\n    const request = { data };\n    try {\n      const response = await this.postChatMessage(url, data);\n      await this.handleResponse(request, response, onResponse, onDone);\n    } catch (error) {\n      onError(request, error);\n    }\n  }\n\n  async postChatMessage(url, data) {\n    this.abortController = new AbortController();\n    const { signal } = this.abortController;\n    const response = await fetch(url, {\n      signal,\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error(`${url} failed with status ${response.status}`);\n    }\n\n    return response;\n  }\n\n  async handleResponse(request, response, onResponse, onDone) {\n    const reader = response.body.getReader();\n    let partialLine = '';\n    var isRequestDone = false;\n\n    while (!isRequestDone) {\n      const { done, value } = await reader.read();\n      if (done) {\n        onDone(request, response);\n        isRequestDone = true;\n        continue;\n      }\n\n      const textChunk = new TextDecoder().decode(value);\n      const lines = (partialLine + textChunk).split('\\n');\n      partialLine = lines.pop();\n\n      lines.forEach((line) => {\n        const responseData = JSON.parse(line);\n        if (line.trim()) {\n          // TODO: Move this line:\n          this.printResponseStats(responseData);\n          onResponse(request, responseData.message.content);\n        }\n      });\n    }\n\n    if (partialLine.trim()) {\n      onResponse(request, partialLine);\n    }\n  }\n\n  abort() {\n    if (this.abortController) {\n      this.abortController.abort();\n    }\n  }\n\n  printResponseStats(data) {\n    if (!data.total_duration) {\n      return;\n    }\n    // Convert nanoseconds to seconds for durations\n    const totalDurationInSeconds = data.total_duration / 1e9;\n    const loadDurationInSeconds = data.load_duration / 1e9;\n    const promptEvalDurationInSeconds = data.prompt_eval_duration / 1e9;\n    const responseEvalDurationInSeconds = data.eval_duration / 1e9;\n\n    // Calculate tokens per second (token/s)\n    const tokensPerSecond = data.eval_count / responseEvalDurationInSeconds;\n    const output = `\nModel: ${data.model}\nCreated At: ${data.created_at}\nTotal Duration (s): ${totalDurationInSeconds.toFixed(2)}\nLoad Duration (s): ${loadDurationInSeconds.toFixed(2)}\nPrompt Evaluation Count: ${data.prompt_eval_count}\nPrompt Evaluation Duration (s): ${promptEvalDurationInSeconds.toFixed(2)}\nResponse Evaluation Count: ${data.eval_count}\nResponse Evaluation Duration (s): ${responseEvalDurationInSeconds.toFixed(2)}\nTokens Per Second: ${tokensPerSecond.toFixed(2)} token/s\n    `;\n    console.log(output);\n  }\n\n  static getModels(url, onResponse) {\n    if (!url) {\n      return null;\n    }\n\n    return fetch(url)\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(`Unable to fetch models from ${url}`);\n        }\n        return response.json();\n      })\n      .then((data) => {\n        onResponse(data.models);\n      })\n      .catch((error) => {\n        console.debug(error);\n        console.error(\n          `Please ensure the server is running at: ${url}. Error code: 39847`,\n        );\n        onResponse([]);\n      });\n  }\n}\n","export class DownloadButton {\n  constructor() {\n    document.addEventListener('click', (event) => {\n      // Check if the clicked element has the class 'copy-button'\n      if (event.target.classList.contains('download-button')) {\n        // Get the index from the data-target attribute\n        const targetId = event.target.getAttribute('data-target');\n        this.downloadElementContent(targetId, 'chat.html');\n      }\n    });\n  }\n\n  downloadElementContent(elementId, filename) {\n    // Get the element\n    const element = document.getElementById(elementId);\n    if (!element) {\n      console.error('Element not found');\n      return;\n    }\n\n    // Get the contents of the element\n    const content = element.innerText;\n\n    // Create a Blob with the content\n    const blob = new Blob([content], { type: 'text/html' });\n\n    // Create an anchor element and set the href to the blob\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = filename;\n\n    // Append the anchor to the document, trigger a click, and then remove it\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n\n    // Revoke the blob URL\n    URL.revokeObjectURL(a.href);\n  }\n}\n","export class DropDownMenu {\n  constructor() {\n    this.buttonSelector = '.drop-down-menu';\n    this.dropDownMenus = document.querySelectorAll(this.buttonSelector);\n    this.init();\n  }\n\n  init() {\n    // Add a click listener to the whole document\n    document.addEventListener('click', (event) => {\n      // Check if the clicked element or any of its parents has the 'drop-down-menu' class\n      const menuElement = event.target.closest(this.buttonSelector);\n      if (menuElement) {\n        const dropDownMenu = menuElement.querySelector('.drop-down-menu-items');\n        if (dropDownMenu) {\n          this.toggleMenu(dropDownMenu);\n        }\n      }\n    });\n  }\n\n  toggleMenu(menu) {\n    menu.classList.toggle('hidden');\n    menu.classList.toggle('visible');\n  }\n}\n","// Modal base class\nexport class Modal {\n  constructor(domId) {\n    this.domId = domId;\n    this.modal = document.getElementById(this.domId);\n    this.closeButton = this.modal.querySelector('.button-close');\n    this.closeButton.onclick = () => this.hide();\n    this._bindEventListeners();\n  }\n\n  _bindEventListeners() {\n    window.addEventListener('keydown', (event) => {\n      if (event.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  show() {\n    this.handleShow();\n  }\n\n  hide() {\n    this.handleHide();\n  }\n\n  handleShow() {\n    this.modal.classList.add('show');\n  }\n\n  handleHide() {\n    this.modal.classList.remove('show');\n  }\n}\n","export class List {\n  constructor(containerId, items, selected) {\n    this.container = document.getElementById(containerId);\n    this.items = items;\n    this.selected = selected;\n    this.render();\n    this.clickHandler = null;\n  }\n\n  onClick(handler) {\n    this.clickHandler = handler;\n    return this; // Allow chaining\n  }\n\n  setItems(items) {\n    this.items = items;\n    this.render();\n  }\n\n  setSelected(selected) {\n    console.debug(`Select ${selected}`);\n    this.selected = selected;\n    this.render();\n  }\n\n  getSelected() {\n    return this.selected;\n  }\n\n  render() {\n    this.container.innerHTML = ''; // Clear existing content\n    const ul = document.createElement('ul');\n    ul.classList.add('list');\n    this.items.forEach((item) => {\n      const li = document.createElement('li');\n      li.classList.add('list-item');\n      if (item === this.selected) {\n        li.classList.add('selected');\n      }\n      li.textContent = item;\n      li.item = item;\n      li.addEventListener('click', () => {\n        this.setSelected(item);\n        if (this.clickHandler) {\n          this.clickHandler(item);\n        }\n      });\n      ul.appendChild(li);\n    });\n    this.container.appendChild(ul);\n  }\n}\n","import { Event } from '../Event.js';\nimport { Settings } from './Settings.js';\nimport { OllamaApi } from '../OllamaApi.js';\n\nexport class Models {\n  static models = [];\n\n  static getUrl() {\n    return Settings.getUrl('/api/tags');\n  }\n\n  static load() {\n    if (!this.getUrl()) {\n      return null;\n    }\n    return OllamaApi.getModels(this.getUrl(), (models) => {\n      Models.models = models;\n      Settings.set('models', Models.models);\n      Event.emit('modelsLoaded', Models.models);\n    });\n  }\n\n  static getAll() {\n    return Models.models;\n  }\n\n  static getNames() {\n    return Models.models.map((model) => model.name);\n  }\n\n  static findModelByName(name) {\n    return Models.models.find((model) => model.name === name);\n  }\n}\n","import { List } from './List.js';\nimport { Event } from './Event.js';\nimport { Models } from './models/Models.js';\n\nexport class ModelsList {\n  constructor(selector, selectedModel) {\n    this.modelList = new List(selector, Models.getNames(), selectedModel);\n    this.bindEventListeners();\n  }\n\n  bindEventListeners() {\n    Event.listen('modelsLoaded', this.handleModelsLoaded.bind(this));\n  }\n\n  handleModelsLoaded() {\n    this.modelList.setItems(Models.getNames());\n  }\n\n  onClick(handler) {\n    this.modelList.clickHandler = handler;\n    return this.modelList; // Allow chaining\n  }\n\n  getSelected() {\n    return this.modelList.selected;\n  }\n}\n","import { Modal } from './Modal.js';\nimport { UINotification } from './UINotification.js';\nimport { ModelsList } from './ModelsList.js';\nimport { Models } from './models/Models.js';\nimport { Settings } from './models/Settings.js';\n\nexport class SettingsDialog extends Modal {\n  constructor() {\n    super('settings-dialog');\n    this.showButton = document.getElementById('settings-button');\n    this.urlInput = document.getElementById('input-url');\n    this.modelInput = document.getElementById('input-model');\n    this.systemPromptInput = this.modal.querySelector('#input-system-prompt');\n    this.modelParametersInput = this.modal.querySelector(\n      '#input-model-parameters',\n    );\n    this.refreshModelsButton = this.modal.querySelector(\n      '.refresh-models-button',\n    );\n    this.modelList = new ModelsList('model-list', Settings.getModel());\n    this.bindEventListeners();\n    this.loadSettings();\n  }\n\n  bindEventListeners() {\n    this.urlInput.addEventListener('blur', () => {\n      const value = this.urlInput.value.trim();\n      Settings.setUrl(value);\n    });\n    this.systemPromptInput.addEventListener('blur', () => {\n      Settings.setSystemPrompt(this.systemPromptInput.value.trim());\n    });\n    this.modelParametersInput.addEventListener('blur', () => {\n      const value = this.modelParametersInput.value.trim();\n      if (value === '') {\n        return;\n      }\n      try {\n        const parsedValue = JSON.parse(value);\n        const prettyJSON = JSON.stringify(parsedValue, 2);\n        Settings.setModelParameters(parsedValue);\n        this.modelParametersInput.value = prettyJSON;\n        this.modelParametersInput.classList.remove('error');\n      } catch (error) {\n        if (error.name === 'SyntaxError') {\n          this.modelParametersInput.classList.add('error');\n        } else {\n          console.error(error);\n        }\n      }\n    });\n    this.modelList.onClick(() => {\n      Settings.setModel(this.modelList.getSelected());\n    });\n    this.showButton.addEventListener('click', this.show.bind(this));\n    this.refreshModelsButton.onclick = () => this.refreshModels();\n    this.closeButton.onclick = () => this.hide();\n  }\n\n  show() {\n    Models.load();\n    this.handleShow();\n  }\n\n  refreshModels() {\n    if (!Models.getUrl()) {\n      UINotification.show('Please update the URL in the settings to continue.');\n    } else {\n      Models.load();\n    }\n  }\n\n  loadSettings() {\n    this.urlInput.value = Settings.getUrl();\n    const modelParameters = Settings.getModelParameters();\n    if (modelParameters) {\n      this.modelParametersInput.value = JSON.stringify(modelParameters, 2);\n    }\n  }\n}\n","import { AppController } from './AppController.js';\nimport { Event } from './Event.js';\nimport { Modal } from './Modal.js';\nimport { Models } from './models/Models.js';\nimport { ModelsList } from './ModelsList.js';\n\nexport class ChatSettingsDialog extends Modal {\n  constructor() {\n    super('chat-settings-dialog');\n    this.showButton = document.getElementById('chat-settings-button');\n    this.bindEventListeners();\n  }\n\n  bindEventListeners() {\n    this.showButton.addEventListener('click', this.show.bind(this));\n    Event.listen('chatSelected', this.handleChatSelected.bind(this));\n  }\n\n  show() {\n    Models.load().then(() => {\n      AppController.getCurrentChat().then((chat) => {\n        this.handleChatSelected(chat);\n        this.handleShow();\n      });\n    });\n  }\n\n  handleChatSelected(chat) {\n    this.modelList = new ModelsList('chat-model-list', chat.model);\n    this.modelList.onClick(async (model) => {\n      chat.model = model;\n      await chat.save();\n    });\n  }\n}\n","export class Hoverable {\n  constructor(element) {\n    this.element = element;\n    element.hoverable = this;\n    this.bindEventListeners();\n  }\n\n  bindEventListeners() {\n    this.element.addEventListener('mouseover', () => this.onMouseover());\n    this.element.addEventListener('mouseout', () => this.onMouseout());\n  }\n\n  onMouseover() {\n    this.element.classList.add('hover');\n  }\n\n  onMouseout() {\n    this.element.classList.remove('hover');\n  }\n}\n","import { Event } from './Event.js';\nimport { AppController } from './AppController.js';\n\nexport class ChatTitle {\n  constructor() {\n    this.defaultTitle = 'Untitled';\n    this.element = document.getElementById('chat-title');\n    this.bindEventListeners();\n    this.render();\n  }\n\n  render() {\n    AppController.getCurrentChat().then((chat) => {\n      this.chat = chat;\n      this.setTitle(chat?.title);\n    });\n  }\n\n  setTitle(title) {\n    this.element.textContent = title || this.defaultTitle;\n  }\n\n  focus() {\n    const hasFocus = document.activeElement === this.element;\n    if (!hasFocus) {\n      this.element.focus();\n    }\n  }\n\n  bindEventListeners() {\n    Event.listen('chatDeleted', this.handleChatDeleted.bind(this));\n    Event.listen('chatSelected', this.handleChatSelected.bind(this));\n    this.element.addEventListener('blur', this.handleSave.bind(this));\n    this.element.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        this.element.blur();\n      }\n    });\n  }\n\n  handleChatSelected(chat) {\n    this.chat = chat;\n    this.setTitle(chat.title);\n  }\n\n  handleChatDeleted(chat) {\n    if (chat.id === this.chat.id) {\n      this.setTitle(this.defaultTitle);\n    }\n  }\n\n  async handleSave() {\n    let title = this.element.textContent.trim();\n    if (title.length === 0) {\n      title = this.defaultTitle;\n      this.element.classList.add('error');\n    } else {\n      this.element.classList.remove('error');\n    }\n    const chat = await AppController.getCurrentChat();\n    if (chat) {\n      await AppController.updateChat(chat, { title });\n    } else {\n      await AppController.createChat({ title });\n    }\n  }\n}\n","// TODO: Move code here from App.js\nexport class ChatForm {\n  constructor() {\n    this.chatHistory = document.getElementById('chat-history');\n    this.messageInput = document.getElementById('message-input');\n    this.sendButton = document.getElementById('send-button');\n    this.abortButton = document.getElementById('abort-button');\n  }\n}\n","import { AppController } from './AppController.js';\nimport { Event } from './Event.js';\nimport { Hoverable } from './Hoverable.js';\nimport { ChatTitle } from './ChatTitle.js';\nimport { ChatForm } from './ChatForm.js';\n\nexport class ChatArea {\n  constructor() {\n    this.chatTitle = new ChatTitle();\n    this.chatForm = new ChatForm();\n    this.chatHistory = document.getElementById('chat-history');\n    this.messageInput = document.getElementById('message-input');\n    this.editChatButton = document.getElementById('edit-chat-button');\n    this.scrollToTopButton = document.getElementById('scroll-to-top-button');\n    this.scrollToEndButton = document.getElementById('scroll-to-end-button');\n    this.deleteChatButton = document.getElementById('delete-chat-button');\n    AppController.getCurrentChat().then((chat) => {\n      this.chat = chat;\n      this.render();\n    });\n    this.bindEventListeners();\n  }\n\n  render() {\n    // Clear history view\n    this.chatHistory.innerText = '';\n    // Render chat history\n    this.chat?.getMessages()?.then((messages) => {\n      messages.forEach((message) => {\n        this.createMessageDiv(message);\n      });\n    });\n    this.scrollToEnd();\n    this.messageInput.focus();\n  }\n\n  bindEventListeners() {\n    Event.listen('chatSelected', this.handleChatSelected.bind(this));\n    Event.listen('chatDeleted', this.handleChatDeleted.bind(this));\n    this.scrollToTopButton.addEventListener(\n      'click',\n      this.scrollToTop.bind(this),\n    );\n    this.scrollToEndButton.addEventListener(\n      'click',\n      this.scrollToEnd.bind(this),\n    );\n    this.editChatButton.addEventListener(\n      'click',\n      this.handleEditChat.bind(this),\n    );\n    this.deleteChatButton.addEventListener(\n      'click',\n      this.handleDeleteChat.bind(this),\n    );\n    this.currentMessage = this.chatHistory.querySelector('.selected');\n    // Select chat message with arrow up and arrow down keys\n    document.addEventListener('keydown', (event) => {\n      let next, previous;\n\n      if (event.key === 'ArrowDown') {\n        next = this.currentMessage ? this.currentMessage.nextElementSibling : this.chatHistory.firstElementChild;\n        if (next) {\n          if (this.currentMessage) this.currentMessage.classList.remove('hover');\n          next.classList.add('hover');\n          this.currentMessage = next; // Update currentMessage\n          this.currentMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); // Scroll into view\n        }\n      } else if (event.key === 'ArrowUp') {\n        previous = this.currentMessage ? this.currentMessage.previousElementSibling : this.chatHistory.lastElementChild;\n        if (previous) {\n          if (this.currentMessage) this.currentMessage.classList.remove('hover');\n          previous.classList.add('hover');\n        }\n        this.currentMessage = previous; // Update currentMessage\n        this.currentMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); // Scroll into view\n      }\n    });\n  }\n\n  createMessageDiv(message) {\n    const role = message.role;\n    const content = message.content;\n    // Get the template and its content\n    const template = document.getElementById('chat-message-template');\n    const messageClone = template.content.cloneNode(true);\n    // Find the div and span elements within the cloned template\n    const messageDiv = messageClone.querySelector('.chat-message');\n    const textSpan = messageClone.querySelector('.chat-message-text');\n    const deleteButton = messageClone.querySelector(\n      '.delete-chat-message-button',\n    );\n\n    // Set the class for role and text content\n    messageDiv.classList.add(`${role}-chat-message`);\n    textSpan.textContent = content;\n    messageDiv.spellcheck = false;\n\n    // Append to chatHistory and adjust scroll\n    this.chatHistory.appendChild(messageDiv);\n    messageDiv.dataset['id'] = message.id;\n    new Hoverable(messageDiv);\n    deleteButton.addEventListener('click', async () => {\n      await AppController.deleteChatMessage(message.id);\n      messageDiv.remove();\n    });\n    return messageDiv;\n  }\n\n  handleChatDeleted(chat) {\n    if (chat.id === this.chat?.id) {\n      this.chat = null;\n    } else {\n      this.chat = chat;\n    }\n    this.render();\n  }\n\n  handleChatSelected(chat) {\n    this.chat = chat;\n    this.render();\n  }\n\n  handleEditChat() {\n    this.chatTitle.focus();\n    event.stopPropagation();\n  }\n\n  async handleDeleteChat() {\n    const chat = await AppController.getCurrentChat();\n    if (chat) {\n      await AppController.deleteChat(chat);\n    }\n  }\n\n  scrollToTop() {\n    this.chatHistory.scrollTop = 0;\n  }\n\n  scrollToEnd() {\n    this.chatHistory.scrollTop = this.chatHistory.scrollHeight;\n  }\n}\n","import { UINotification } from './UINotification.js';\nimport { Settings } from './models/Settings.js';\nimport { Event } from './Event.js';\nimport { DOM } from './Dom.js';\nimport { Sidebar } from './Sidebar.js';\nimport { AppController } from './AppController.js';\nimport { CopyButton } from './CopyButton.js';\nimport { OllamaApi } from './OllamaApi.js';\nimport { DownloadButton } from './DownloadButton.js';\nimport { DropDownMenu } from './DropDownMenu.js';\nimport { SettingsDialog } from './SettingsDialog.js';\nimport { ChatSettingsDialog } from './ChatSettingsDialog.js';\n// import { MarkdownFormatter } from './MarkdownFormatter.js'\nimport { ChatArea } from './ChatArea.js';\n\n// TODO: Review and refactor\nexport class App {\n  static run() {\n    UINotification.initialize();\n    const app = new App();\n    return app;\n  }\n\n  constructor() {\n    this.sidebar = new Sidebar();\n    this.chatArea = new ChatArea();\n    this.ollamaApi = new OllamaApi();\n    this.settingsDialog = new SettingsDialog();\n    this.chatSettingsDialog = new ChatSettingsDialog();\n    this.downloadButton = new DownloadButton();\n    this.copyButton = new CopyButton();\n    this.dropDownMenu = new DropDownMenu();\n    this.initializeElements();\n    this.bindEventListeners();\n    this.logInitialization();\n    this.render();\n  }\n\n  initializeElements() {\n    // this.sendButton = document.getElementById('send-button');\n    this.abortButton = document.getElementById('abort-button');\n    this.messageInput = document.getElementById('message-input');\n    this.chatHistory = document.getElementById('chat-history');\n  }\n\n  logInitialization() {\n    const msg = `~~~~\\nChat\\n~~~~\nModel:       ${Settings.getModel()}\nURL:         ${Settings.getUrl()}\nChat:        ${Settings.getCurrentChatId()}\nParameters:  ${JSON.stringify(Settings.getModelParameters())}\n`;\n    console.log(msg);\n  }\n\n  render() {\n    this.sidebar.render();\n    this.chatArea.render();\n  }\n\n  bindEventListeners() {\n    Event.listen('chatSelected', this.handleChatSelected);\n    // this.sendButton.addEventListener('click', this.sendMessage.bind(this));\n    this.abortButton.addEventListener('click', this.handleAbort.bind(this));\n    this.messageInput.addEventListener(\n      'keypress',\n      this.handleKeyPress.bind(this),\n    );\n  }\n\n  handleChatSelected = (chat) => {\n    window.history.pushState({}, '', `/chats/${chat.id}`);\n  };\n\n  handleAbort = () => {\n    this.ollamaApi.abort();\n    this.enableForm();\n    console.log('Request aborted');\n  };\n\n  handleKeyPress = (event) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      this.sendMessage();\n    }\n  };\n\n  enableForm() {\n    DOM.hideElement(this.abortButton)\n      .enableInput(this.messageInput);\n    this.messageInput.focus();\n  }\n\n  disableForm() {\n    DOM.showElement(this.abortButton)\n      .disableInput(this.messageInput);\n  }\n\n  // https://github.com/jmorganca/ollama/blob/main/docs/api.md#generate-a-completion\n  async sendMessage() {\n    const userMessage = this.messageInput.value.trim();\n    // Get the current chat\n    let chat = await AppController.getCurrentChat();\n    const url = Settings.getUrl('/api/chat');\n    if (!url) {\n      UINotification.show(\n        'Please update the URL in the settings to continue. ',\n      );\n      return null;\n    }\n    if (userMessage) {\n      // Reset input\n      this.messageInput.value = '';\n      // Create new chat\n      if (!chat) {\n        chat = await AppController.createChat({\n          title: 'Untitled',\n          model: Settings.getModel(),\n        });\n      }\n      // Store user message\n      await chat.addMessage({\n        role: 'user',\n        content: userMessage,\n      });\n      const systemPrompt = Settings.getSystemPrompt();\n      const modelParameters = Settings.getModelParameters();\n      // Disable form\n      this.disableForm();\n      // Create user message\n      this.createChatMessage({ content: userMessage, role: 'user' });\n      // Create system message container\n      const responseElement = this.createChatMessage({\n        content: '',\n        role: 'system',\n      });\n      const requestContext = {\n        chat,\n        content: '', // TODO: Move this to the response?\n        responseElement,\n      };\n      const requestData = {\n        prompt: userMessage,\n        model: chat.model,\n        messages: (await chat.getMessages()).map((message) => ({\n          role: message.role,\n          content: message.content,\n        })),\n      };\n      // Add system prompt\n      if (systemPrompt) {\n        requestData.system = systemPrompt;\n      }\n      // Add model parameters\n      if (modelParameters) {\n        requestData.options = modelParameters;\n      }\n      // Show spinner\n      responseElement.innerHTML = '<div class=\"waiting\"></div>';\n      // Make request\n      this.ollamaApi.send(\n        url,\n        requestData,\n        (request, response) =>\n          this.handleResponse(request, response, requestContext),\n        (request, error) => this.handleResponseError(request, error),\n        (request, response) =>\n          this.handleDone(request, response, requestContext),\n      );\n    }\n  }\n\n  createChatMessage(message) {\n    return this.chatArea.createMessageDiv(message);\n  }\n\n  handleResponse(request, response, context) {\n    const responseElement = context.responseElement;\n    const sanitizedContent = this.sanitizeContent(response);\n    // Remember original response\n    context.content += sanitizedContent;\n    responseElement.textContent += sanitizedContent;\n    this.chatArea.scrollToEnd();\n  }\n\n  handleResponseError(request, error) {\n    // Ignore \"Abort\" button\n    if (error.name !== 'AbortError') {\n      console.error(`Error: ${error.message}`);\n    }\n    this.chatArea.scrollToEnd();\n    this.enableForm();\n  }\n\n  async handleDone(request, response, context) {\n    const chat = context.chat;\n    console.log(`Chat ${chat.id} done`);\n    await chat.addMessage({\n      role: 'assistant',\n      content: context.content,\n    });\n    this.enableForm();\n  }\n\n  sanitizeContent = (content) => {\n    // TODO: Sanitization logic here\n    return content;\n  };\n\n  getIdParam = () => {\n    return new URL(window.location.href).pathname.split('/').pop();\n  };\n}\n","import { App } from './App.js';\nimport { Chat } from './models/Chat.js';\nimport { ChatMessage } from './models/ChatMessage.js';\n\n// TODO: refactor\nasync function initialize() {\n  await Chat.initialize();\n  await ChatMessage.initialize();\n}\n\ninitialize().then(() => {\n  App.run();\n});\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}